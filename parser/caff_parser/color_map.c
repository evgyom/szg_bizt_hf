#include "color_map.h"

int get_most_similar_color(color_t color, unsigned char * color_map, int colors_in_map){
    int i, min_index;
    float min_dist = 255*255;
    float dist;
    color_t color_in_map;
    for(i = 0; i<colors_in_map; i++){
        color_in_map.r = color_map[3*i];
        color_in_map.g = color_map[3*i+1];
        color_in_map.b = color_map[3*i+2];
        dist = get_color_similiarity(color, color_in_map);
        if(dist < min_dist){
            min_dist = dist;
            min_index = i;
        }
    }
    return min_index;
}

float get_color_similiarity(color_t color_1, color_t color_2){
    return (0.3 * (color_1.r - color_2.r)*(color_1.r - color_2.r)) + 
           (0.59 * (color_1.g - color_2.g)*(color_1.g - color_2.g)) +
           (0.11 * (color_1.b - color_2.b)*(color_1.b - color_2.b));
}

color_t arr_to_color(unsigned char * arr){
    color_t retval = {arr[0],arr[1],arr[2]};
    return retval;
}

unsigned char color_map_256[COLOR_MAP_SIZE*3] = {
    0, 0, 0,
    0, 0, 1,
    0, 1, 0, 
    1, 0, 0, 
    1, 0, 1, 
    0, 0, 51, 
    0, 0, 102, 
    0, 0, 153, 
    0, 0, 204, 
    0, 0, 255, 
    0, 42, 0, 
    0, 42, 51, 
    0, 42, 102, 
    0, 42, 153, 
    0, 42, 204, 
    0, 42, 255, 
    0, 84, 0, 
    0, 84, 51, 
    0, 84, 102, 
    0, 84, 153, 
    0, 84, 204, 
    0, 84, 255, 
    0, 126, 0, 
    0, 126, 51, 
    0, 126, 102, 
    0, 126, 153, 
    0, 126, 204, 
    0, 126, 255, 
    0, 168, 0, 
    0, 168, 51, 
    0, 168, 102, 
    0, 168, 153, 
    0, 168, 204, 
    0, 168, 255, 
    0, 210, 0, 
    0, 210, 51, 
    0, 210, 102, 
    0, 210, 153, 
    0, 210, 204, 
    0, 210, 255, 
    0, 255, 0, 
    0, 255, 51, 
    0, 255, 102, 
    0, 255, 153, 
    0, 255, 204, 
    0, 255, 255, 
    51, 0, 0, 
    51, 0, 51, 
    51, 0, 102, 
    51, 0, 153, 
    51, 0, 204, 
    51, 0, 255, 
    51, 42, 0, 
    51, 42, 51, 
    51, 42, 102, 
    51, 42, 153, 
    51, 42, 204, 
    51, 42, 255, 
    51, 84, 0, 
    51, 84, 51, 
    51, 84, 102, 
    51, 84, 153, 
    51, 84, 204, 
    51, 84, 255, 
    51, 126, 0, 
    51, 126, 51, 
    51, 126, 102, 
    51, 126, 153, 
    51, 126, 204, 
    51, 126, 255, 
    51, 168, 0, 
    51, 168, 51, 
    51, 168, 102, 
    51, 168, 153, 
    51, 168, 204, 
    51, 168, 255, 
    51, 210, 0, 
    51, 210, 51, 
    51, 210, 102, 
    51, 210, 153, 
    51, 210, 204, 
    51, 210, 255, 
    51, 255, 0, 
    51, 255, 51, 
    51, 255, 102, 
    51, 255, 153, 
    51, 255, 204, 
    51, 255, 255, 
    102, 0, 0, 
    102, 0, 51, 
    102, 0, 102, 
    102, 0, 153, 
    102, 0, 204, 
    102, 0, 255, 
    102, 42, 0, 
    102, 42, 51, 
    102, 42, 102, 
    102, 42, 153, 
    102, 42, 204, 
    102, 42, 255, 
    102, 84, 0, 
    102, 84, 51, 
    102, 84, 102, 
    102, 84, 153, 
    102, 84, 204, 
    102, 84, 255, 
    102, 126, 0, 
    102, 126, 51, 
    102, 126, 102, 
    102, 126, 153, 
    102, 126, 204, 
    102, 126, 255, 
    102, 168, 0, 
    102, 168, 51, 
    102, 168, 102, 
    102, 168, 153, 
    102, 168, 204, 
    102, 168, 255, 
    102, 210, 0, 
    102, 210, 51, 
    102, 210, 102, 
    102, 210, 153, 
    102, 210, 204, 
    102, 210, 255, 
    102, 255, 0, 
    102, 255, 51, 
    102, 255, 102, 
    102, 255, 153, 
    102, 255, 204, 
    102, 255, 255, 
    153, 0, 0, 
    153, 0, 51, 
    153, 0, 102, 
    153, 0, 153, 
    153, 0, 204, 
    153, 0, 255, 
    153, 42, 0, 
    153, 42, 51, 
    153, 42, 102, 
    153, 42, 153, 
    153, 42, 204, 
    153, 42, 255, 
    153, 84, 0, 
    153, 84, 51, 
    153, 84, 102, 
    153, 84, 153, 
    153, 84, 204, 
    153, 84, 255, 
    153, 126, 0, 
    153, 126, 51, 
    153, 126, 102, 
    153, 126, 153, 
    153, 126, 204, 
    153, 126, 255, 
    153, 168, 0, 
    153, 168, 51, 
    153, 168, 102, 
    153, 168, 153, 
    153, 168, 204, 
    153, 168, 255, 
    153, 210, 0, 
    153, 210, 51, 
    153, 210, 102, 
    153, 210, 153, 
    153, 210, 204, 
    153, 210, 255, 
    153, 255, 0, 
    153, 255, 51, 
    153, 255, 102, 
    153, 255, 153, 
    153, 255, 204, 
    153, 255, 255, 
    204, 0, 0, 
    204, 0, 51, 
    204, 0, 102, 
    204, 0, 153, 
    204, 0, 204, 
    204, 0, 255, 
    204, 42, 0, 
    204, 42, 51, 
    204, 42, 102, 
    204, 42, 153, 
    204, 42, 204, 
    204, 42, 255, 
    204, 84, 0, 
    204, 84, 51, 
    204, 84, 102, 
    204, 84, 153, 
    204, 84, 204, 
    204, 84, 255, 
    204, 126, 0, 
    204, 126, 51, 
    204, 126, 102, 
    204, 126, 153, 
    204, 126, 204, 
    204, 126, 255, 
    204, 168, 0, 
    204, 168, 51, 
    204, 168, 102, 
    204, 168, 153, 
    204, 168, 204, 
    204, 168, 255, 
    204, 210, 0, 
    204, 210, 51, 
    204, 210, 102, 
    204, 210, 153, 
    204, 210, 204, 
    204, 210, 255, 
    204, 255, 0, 
    204, 255, 51, 
    204, 255, 102, 
    204, 255, 153, 
    204, 255, 204, 
    204, 255, 255, 
    255, 0, 0, 
    255, 0, 51, 
    255, 0, 102, 
    255, 0, 153, 
    255, 0, 204, 
    255, 0, 255, 
    255, 42, 0, 
    255, 42, 51, 
    255, 42, 102, 
    255, 42, 153, 
    255, 42, 204, 
    255, 42, 255, 
    255, 84, 0, 
    255, 84, 51, 
    255, 84, 102, 
    255, 84, 153, 
    255, 84, 204, 
    255, 84, 255, 
    255, 126, 0, 
    255, 126, 51, 
    255, 126, 102, 
    255, 126, 153, 
    255, 126, 204, 
    255, 126, 255, 
    255, 168, 0, 
    255, 168, 51, 
    255, 168, 102, 
    255, 168, 153, 
    255, 168, 204, 
    255, 168, 255, 
    255, 210, 0, 
    255, 210, 51, 
    255, 210, 102, 
    255, 210, 153, 
    255, 210, 204, 
    255, 210, 255, 
    255, 255, 0, 
    255, 255, 51, 
    255, 255, 102, 
    255, 255, 153, 
    255, 255, 204, 
    255, 255, 255 
};